<html>

<head>
    <title>
        Bubbles
    </title>
    <script type="module">
        import { forceSimulation } from "https://cdn.skypack.dev/d3-force@3";
        import { selectAll } from "https://cdn.skypack.dev/d3-selection@3";

        const bubbles = [];
        addBubble(bubbles, "my-id-123", 50);
        addBubble(bubbles, "my-id-444", 60);

        const simulation = forceSimulation(bubbles);
        simulation.alphaDecay(0);
        simulation.on("tick", tick);

        function addBubble(bubbles, id, targetValue) {
            bubbles.push({
                "r": targetValue,
                "key": id,
                "x": Math.floor(Math.random() * (window.innerWidth - targetValue)),
                "y": window.innerHeight + targetValue
            });
        }

        function isInViewPort(bubble) {
            return bubble.y + bubble.r > 0;
        }

        function tick() {
            for (let i = bubbles.length - 1; i >= 0; i--) {
                bubbles[i].y -= 1.3;
                if (!isInViewPort(bubbles[i])) {
                    bubbles.splice(i, 1);
                }
            }
            selectAll("#bubbles").selectAll("circle")
                .data(bubbles)
                .join("circle")
                .attr("cx", function (bubble) { return bubble.x; })
                .attr("cy", function (bubble) { return bubble.y; })
                .attr("r", function (bubble) { return bubble.r; })
                .attr("fill", "green");
        }
    </script>
</head>

<body>
    <svg id="bubbles" width="100%" height="100%"></svg>
</body>



</html>